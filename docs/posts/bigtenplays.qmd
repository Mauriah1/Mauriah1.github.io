---
title: "Average Plays for the Big10"
author: "Mauriah Allen"
date: '2024-10-03'
format:
  html:
    code-fold: true
---

```{r}
library(tidyverse)

Logs23 <- read_csv("https://dwillis.github.io/sports-data-files/footballlogs23.csv")

Logs24 <- read_csv("https://dwillis.github.io/sports-data-files/footballlogs24.csv")
```

### Filter out each big 10 team offensive play in the year of 2023

```{r}
  big10teams23 <- Logs23|> 
  group_by(Conference, Team) |> 
  summarise(
   OffensivePlays= sum(OffensivePlays),
  ) |>  filter(Conference == "Big Ten Conference") 

```
All teams are mostly over 800 plays for the 2023 season besides Nebraska and Michigan State, Penn State and Michigan are really high in number of plays with 928 and 924 plays.


### Filter out each big 10 team offensive play in the year of 2024

```{r}
big10teams24 <- Logs24 |> group_by(Conference, Team) |> 
  summarise(
    OffensivePlays= sum(OffensivePlays)
  ) |>  filter(Conference == "Big Ten Conference") 

```
The season has not concluded so there is less data than in 2023, but from the data so far most teams have had over 300 plays besides UCLA and Purdue, while Indiana and Nebraska are at the top of the list.


### Find average plays for big 10 teams in 2023

```{r}
avg_offensive_plays_2023 <- big10teams23 |>
  group_by(Team) |> 
  summarise(avg_plays = mean(OffensivePlays, na.rm = TRUE))
```

### Find average plays for big 10 teams in 2023

```{r}
avg_offensive_plays_2024 <- big10teams24 |> 
  group_by(Team) |> 
  summarise(avg_plays = mean(OffensivePlays, na.rm = TRUE))
```

### Plot the averages for the number of plays for the 2023 season

```{r}
ggplot(avg_offensive_plays_2023, aes(x = reorder(Team, -avg_plays), y = avg_plays)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(title = "Average Offensive Plays per Game in 2023", x = "Team", y = "Average Plays") +
  theme_minimal() + 
  coord_flip()
```
Penn State and Michigan, as expected is very high on the list, Michigan just won the championship. But Maryland is fourth from the top which shows they make a pretty good amount of plays. On the other hand Nebraska is very low which can show many things like maybe they had a problem with penalties, and couldn't run a smooth offense or maybe there offense of line wasn't good and the quaterback cant make many plays. The biggest lesson of this chart is that most of the teams who make more plays have a better record and tend to have a better season.

### Plot the averages for the number of plays for the 2024 season

```{r}
ggplot(avg_offensive_plays_2024, aes(x = reorder(Team, -avg_plays), y = avg_plays)) +
  geom_bar(stat = "identity", fill = "darkorange") +
  labs(title = "Average Offensive Plays per Game in 2024", x = "Team", y = "Average Plays") +
  theme_minimal() +
  coord_flip()
```
The season has not concluded so there is much less plays compared to the year in 2023, however Nebraska looks to improve by a lot more compared to the last season. They are in the top of this chart, which means they are making many plays. This could be a significant increase unless they start the season off strong, moving their offense then later in the year get startled. However, Maryland is still near the top off plays which is pretty good.
